<!DOCTYPE html>
<html>
<head>
    <title>Mapbox GL JS debug page</title>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link rel='stylesheet' href='../dist/mapbox-gl.css'/>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        html, body, #map {
            height: 100%;
        }
    </style>
</head>

<body>
<div id='map'></div>

<script src='../dist/mapbox-gl-dev.js'></script>
<script src='../debug/access_token_generated.js'></script>
<script>
    mapboxgl.accessToken = "pk.eyJ1IjoibW91cm5lciIsImEiOiJWWnRiWG1VIn0.j6eccFHpE3Q04XPLI7JxbA"
    var map = window.map = new mapboxgl.Map({
        container: 'map',
        zoom: 12.5,
        center: [-77.01866, 38.888],
        style: 'mapbox://styles/mapbox/streets-v12',
        projection: 'globe',
        hash: true
    });
    // setTimeout(() => {
    //     map.setLayoutProperty('road-label', 'text-field', 'b = 1526623.978m')
    // }, 1000)
    map.on('load', () => {

        map.addLayer({
            "id": "countours",
            "type": "line",
            "filter": ['==', ['%', ['get', 'ele'], 100], 0],
            "source": {
                type: 'vector',
                url: 'mapbox://mapbox.mapbox-terrain-v2'
            },
            "source-layer": "contour",
            'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
            },
            'paint': {
                'line-color': '#877b59',
                'line-width': 1
            }
        })

        /*map.addLayer({
            "id": "countours_fill",
            "type": "fill",
            "filter": ['==', ['%', ['get', 'ele'], 50], 0],
            "source": {
                type: 'vector',
                url: 'mapbox://mapbox.mapbox-terrain-v2'
            },
            "source-layer": "contour",
            'layout': {
                'visibility': 'visible',
                // 'line-join': 'round',
                // 'line-cap': 'round'
            },
            'paint': {
                'fill-color': ['interpolate', ["linear"], ['get', 'ele'], 0, 'rgba(236,162,100, 0.5)', 100, 'rgba(135,178,71, 0.5)', 500, 'rgba(234,73,73, 0.5)', 1000, 'rgba(208,141,46, 0.5)', 10000 ,'rgba(233, 0, 0, 0.5)'],
                // 'line-width': 1
            }
        })*/

        map.addLayer({
            "id": "countour-labels",
            "type": "symbol",
            "filter": ['==', ['%', ['get', 'ele'], 100], 0],
            "source": {
                type: 'vector',
                url: 'mapbox://mapbox.mapbox-terrain-v2'
            },
            "source-layer": "contour",
            'layout': {
                'visibility': 'visible',
                'symbol-placement': 'line',
                'text-field': ['concat', ['to-string', ['get', 'ele']], 'm'],
                // 'text-pitch-alignment': 'viewport'
            },
            'paint': {
                'icon-color': '#877b59',
                'icon-halo-width': 1,
                'text-color': '#877b59',
                'text-halo-width': 1
            }
        })

        map.addSource('mapbox-dem', {
            'type': 'raster-dem',
            'url': 'mapbox://mapbox.mapbox-terrain-dem-v1',
            'tileSize': 512,
            'maxzoom': 14
        });
        // add the DEM source as a terrain layer with exaggerated height
        map.setTerrain({ 'source': 'mapbox-dem', 'exaggeration': 1 });
        // map.showTerrainWireframe = true;
    })
</script>
</body>
</html>
